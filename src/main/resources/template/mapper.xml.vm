<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="${package}.mapper.${className}Mapper">

#if(${baseResultMap})
	<!-- 通用查询映射结果 -->
	<resultMap id="BaseResultMap" type="${package}.model.${className}Model">
		#foreach($column in $columns)
            <result property="${column.attrname}" column="${column.columnName}"/>
		#end
	</resultMap>


#end

<sql id="baseColumns">
	#set($comma = false)
	#foreach($col in $columns)
	#if($comma),
	#end
	${col.columnName}
	#set($comma=true)
	#end
</sql>



<sql id="queryConditions">
	WHERE 1=1
#set($comma = false)
#foreach($col in $columns)
#if($comma)
 </if>
#end
	#if ( $col.attrType=="Long" )
	<if test="${secondModuleName}Model.${col.attrname} > 0 ">
		AND ${col.columnName} =	#{${secondModuleName}Model.${col.attrname}}
	#elseif ( $col.attrType=="Integer" )
	<if test="${secondModuleName}Model.${col.attrname} > 0 ">
		AND ${col.columnName} =	#{${secondModuleName}Model.${col.attrname}}
	#else
	<if test="${secondModuleName}Model.${col.attrname} != null">
	AND ${col.columnName} =	#{${secondModuleName}Model.${col.attrname}}
	#end
#set($comma=true)
#end
</if>	
</sql>


<sql id="limit">
	<if test="page != null">
		limit #{page.start},#{page.pageSize}
	</if>
</sql>



<insert id="save${className}Model" parameterType="${package}.model.${className}Model" useGeneratedKeys="true" keyProperty="${pk.attrName}" keyColumn="${pk.columnName}">
		insert into ${tableName}
		<trim prefix="(" suffix=")" suffixOverrides=",">
#set($comma = false)
#foreach($col in  $columns)
			#if($comma), 
        </if>
#end
#if ( $col.attrType=="Long" )
		<if test="${secondModuleName}Model.${col.attrname} >0">
				${col.columnName}
#elseif ( $col.Type=="Integer" )
		<if test="${secondModuleName}Model.${col.attrname} >0">
				${col.columnName}
#else
		<if test="${secondModuleName}Model.${col.attrname} != null">
				${col.columnName}
#end		
#set($comma=true)
#end
		</if>

		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			
#set($comma = false)
#foreach($col in $columns)
				#if($comma), 
		 </if>
#end
#if ( $col.attrType=="Long" )
			<if test="${secondModuleName}Model.${col.attrname} >0">
			#{${secondModuleName}Model.${col.attrname}}
#elseif ( $col.Type=="Integer" )
			<if test="${secondModuleName}Model.${col.attrname} >0">
			#{${secondModuleName}Model.${col.attrname}}
#else
			<if test="${secondModuleName}Model.${col.attrname} != null">
			#{${secondModuleName}Model.${col.attrname}}
#end		
#set($comma=true)
#end
			</if>	
		</trim>
		</insert>
		
		
	<insert id="saveList${className}Model" parameterType="${package}.model.${className}Model" >
		insert into  ${tableName}
			<trim prefix="(" suffix=")" suffixOverrides=",">
#set($comma = false)
#foreach($col in $columns)
					#if($comma), 
		        	</if>
#end
				
#if ( $col.attrType=="Long" )
					<if test="${secondModuleName}Model.${col.attrname} >0">
						${col.columnName}
#elseif ( $col.attrType=="Integer" )
					<if test="${secondModuleName}Model.${col.attrname} >0">
						${col.columnName}
#else
					<if test="${secondModuleName}Model.${col.attrname} != null">
									${col.columnName}
#end		
#set($comma=true)
#end
					</if>
			</trim>
		VALUES
			<foreach collection="list${className}Model" item="${secondModuleName}Model" index="index"
				separator="," >
			(
#set($comma = false)
#foreach($col in $columns)
				#if($comma), 
			     	</if>
#end
			
#if ( $col.attrType=="Long" )
				<if test="${secondModuleName}Model.${col.attrname} >0">
				#{${secondModuleName}Model.${col.attrname}}
#elseif ( $col.attrType=="Integer" )
				<if test="${secondModuleName}Model.${col.attrname} >0">
				#{${secondModuleName}Model.${col.attrname}}
#else
				<if test="${secondModuleName}Model.${col.attrname} != null">
				#{${secondModuleName}Model.${col.attrname}}
#end
#set($comma=true)
#end
				</if>	
			)
			</foreach>
		</insert>	
		
		
	<select id="queryDetail${className}Model" parameterType="${package}.model.${className}Model" resultMap="baseResultMap" >
		select <include refid="baseColumns"/>  from ${tableName} 
		<include refid="queryConditions"/>
	</select>	
	
	
	<select id="queryList${className}Model" resultMap="baseResultMap"
		parameterType="${package}.model.${className}Model">
		select <include refid="baseColumns"/> from ${tableName} 
			<include refid="queryConditions"/>
				order by ${pk.columnName} desc
	</select>
	
	
	<select id="queryCount${className}Model" parameterType="${package}.model.${className}Model"
		resultType="java.lang.Long">
		SELECT COUNT(1) FROM ${tableName} 
		<include refid="queryConditions"/>
	</select>
	
	
	
	
	<update id="update${className}Model" parameterType="${package}.model.${className}Model" >
		update ${tableName} 
		<set> 
#set($comma = false)
#foreach($col in $columns)
			#if($comma),
			</if>
#end
					
#if ( $col.attrType=="Long" )
			<if test="${secondModuleName}Model.${col.attrname} > 0">
				${col.columnName} = #{${secondModuleName}Model.${col.attrname}}
#elseif ( $col.attrType=="Integer" )
			<if test="${secondModuleName}Model.${col.attrname} >0">
				${col.columnName} = #{${secondModuleName}Model.${col.attrname}}
#else
			<if test="${secondModuleName}Model.${col.attrname} != null">
				${col.columnName} =	#{${secondModuleName}Model.${col.attrname}}
#end	
#set($comma=true)
#end
			</if>
		</set>	
			where ${pk.columnName} = #{${pk.attrName}} 
	</update>
	
	
	<delete id="delete${className}Model" parameterType="${package}.model.${className}Model">
		 delete from ${tableName} 
		 
		<include refid="queryConditions"/>
	</delete>
	
	


</mapper>
